"use strict";!function(a,e){function t(a){return a&&a.__esModule?a:{default:a}}var n=a.exports={};window=e("../../npm/labrador/global.js");Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../npm/babel-runtime/regenerator/index.js"),u=t(r),l=e("../../npm/babel-runtime/helpers/asyncToGenerator.js"),s=t(l),i=e("../../npm/babel-runtime/core-js/object/get-prototype-of.js"),d=t(i),o=e("../../npm/babel-runtime/helpers/classCallCheck.js"),c=t(o),f=e("../../npm/babel-runtime/helpers/createClass.js"),p=t(f),h=e("../../npm/babel-runtime/helpers/possibleConstructorReturn.js"),m=t(h),b=e("../../npm/babel-runtime/helpers/inherits.js"),x=t(b),k=e("../../npm/labrador/index.js"),v=t(k),w=function(a){function e(){var a,t,n,r;(0,c.default)(this,e);for(var u=arguments.length,l=Array(u),s=0;s<u;s++)l[s]=arguments[s];return t=n=(0,m.default)(this,(a=e.__proto__||(0,d.default)(e)).call.apply(a,[this].concat(l))),n.data={index:"",url:"",value:"",txt:"",subUrl:"",nickName:"",email:"",arg:""},r=t,(0,m.default)(n,r)}return(0,x.default)(e,a),(0,p.default)(e,[{key:"onSub",value:function(){function a(a){return e.apply(this,arguments)}var e=(0,s.default)(u.default.mark(function a(e){var t,n;return u.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t={},!this.data.nickName){a.next=5;break}t={code:v.default.app.globalData.storage.code,nickName:this.data.nickName},a.next=13;break;case 5:if(!this.data.email){a.next=9;break}t={code:v.default.app.globalData.storage.code,email:this.data.email},a.next=13;break;case 9:if(""!=this.data.email){a.next=11;break}return a.abrupt("return",v.default.showModal({title:"提示",content:"邮箱不能为空！",showCancel:!1,success:function(a){}}));case 11:if(""!=this.data.nickName){a.next=13;break}return a.abrupt("return",v.default.showModal({title:"提示",content:"昵称不能为空！",showCancel:!1,success:function(a){}}));case 13:return a.next=15,v.default.request({url:this.data.subUrl,method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:t});case 15:if(n=a.sent,0!=n.data.status){a.next=23;break}return v.default.app.globalData.userInfo.nickName=this.data.nickName,a.next=20,v.default.setStorage({key:"userInfo",data:v.default.app.globalData.userInfo});case 20:v.default.navigateBack(),a.next=24;break;case 23:v.default.showModal({title:"提示",content:n.data.msg,showCancel:!1,success:function(a){}});case 24:case"end":return a.stop()}},a,this)}));return a}()},{key:"onLoad",value:function(){function a(a){return e.apply(this,arguments)}var e=(0,s.default)(u.default.mark(function a(e){var t,n;return u.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=parseInt(e.type),1==t?this.setData({url:v.default.app.data.ajaxPath+"/wxapi/user/userInfo/nickname",subUrl:v.default.app.data.ajaxPath+"/wxapi/user/userInfo/modifyNickName",value:"",txt:"昵称",placeholder:"昵称",email:null,index:t}):2==t&&this.setData({url:v.default.app.data.ajaxPath+"/wxapi/user/userInfo/email",subUrl:v.default.app.data.ajaxPath+"/wxapi/user/userInfo/modifyEmail",value:"",placeholder:"请输入您的邮箱",txt:"邮箱",nickName:null,index:t}),a.next=4,v.default.request({url:this.data.url,method:"GET",header:{"content-type":"application/x-www-form-urlencoded"},data:{code:v.default.app.globalData.storage.code}});case 4:n=a.sent,0==n.data.status?n.data.data?1==t?this.setData({nickName:n.data.data,value:n.data.data}):2==t&&this.setData({email:n.data.data,value:n.data.data}):this.setData({value:this.data.value}):v.default.showModal({title:"提示",content:n.data.data.msg,success:function(a){}});case 6:case"end":return a.stop()}},a,this)}));return a}()},{key:"bindKeyInput",value:function(a){var e=a.currentTarget.dataset.index;1==e?this.setData({nickName:a.detail.value}):2==e&&this.setData({email:a.detail.value})}}]),e}(v.default.Component);Page(k._createPage(w))}(module,require);