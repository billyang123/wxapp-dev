"use strict";!function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}var n=e.exports={};window=t("../../npm/labrador/global.js");Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../npm/babel-runtime/regenerator/index.js"),s=a(r),o=t("../../npm/babel-runtime/helpers/asyncToGenerator.js"),u=a(o),l=t("../../npm/babel-runtime/core-js/object/get-prototype-of.js"),c=a(l),i=t("../../npm/babel-runtime/helpers/classCallCheck.js"),d=a(i),p=t("../../npm/babel-runtime/helpers/createClass.js"),f=a(p),h=t("../../npm/babel-runtime/helpers/possibleConstructorReturn.js"),m=a(h),b=t("../../npm/babel-runtime/helpers/inherits.js"),x=a(b),g=t("../../npm/labrador/index.js"),v=a(g),j=t("../../components/alert/alert.js"),k=a(j),q=function(e){function t(){var e,a,n,r;(0,d.default)(this,t);for(var s=arguments.length,o=Array(s),u=0;u<s;u++)o[u]=arguments[u];return a=n=(0,m.default)(this,(e=t.__proto__||(0,c.default)(t)).call.apply(e,[this].concat(o))),n.data={qid:"",cid:"",url:"",content:""},n.children={alert:new k.default({msg:"@msg"})},r=a,(0,m.default)(n,r)}return(0,x.default)(t,e),(0,f.default)(t,[{key:"formSubmit",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,u.default)(s.default.mark(function e(t){var a,n,r,o;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.detail.value.content,a=a.replace(/^(\s|\u00A0)+|(\s|\u00A0)+$/g,""),""!=a){e.next=4;break}return e.abrupt("return",this.children.alert.show("请输入评论内容"));case 4:if(!(a.length>=60)){e.next=6;break}return e.abrupt("return",this.children.alert.show("评论内容需少于60个字"));case 6:return this.postdata.content=a,e.next=9,v.default.app.ajax({url:this.url,type:"post",data:this.postdata});case 9:if(n=e.sent,0!=n.status){e.next=21;break}return e.next=13,v.default.getStorage({key:"userInfo"});case 13:return r=e.sent,console.log(r),e.next=17,v.default.showToast({title:"评论成功",icon:"success",duration:2e3});case 17:return e.next=19,v.default.setStorage({key:"commit",data:{nickName:r.data.nickName,content:a}});case 19:this.setData({content:""}),setTimeout(function(){v.default.navigateBack()},2e3);case 21:if(1!=n.status){e.next=26;break}return e.next=24,v.default.showModal({title:"提示",content:"需要先登录"});case 24:o=e.sent,o.confirm&&v.default.redirectTo({url:"/pages/account/account"});case 26:case"end":return e.stop()}},e,this)}));return e}()},{key:"onLoad",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,u.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:v.default.app.stopAudio(),console.log(t),this.postdata={code:v.default.app.globalData.storage.code},t.qaCommentId&&(this.postdata.qaCommentId=t.qaCommentId,this.qaId=t["amp;qaId"],this.url="https://xcx.chinamuxie.com/wxapi/healthserv/qacomment/reply"),t.qaId&&(this.postdata.qaId=t.qaId,this.qaId=t.qaId,this.url="https://xcx.chinamuxie.com/wxapi/healthserv/qacomment/add"),console.log(t);case 6:case"end":return e.stop()}},e,this)}));return e}()}]),t}(v.default.Component);Page(g._createPage(q))}(module,require);