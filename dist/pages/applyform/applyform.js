"use strict";!function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}var n=e.exports={};window=t("../../npm/labrador/global.js");Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../npm/babel-runtime/regenerator/index.js"),s=a(r),u=t("../../npm/babel-runtime/helpers/asyncToGenerator.js"),o=a(u),l=t("../../npm/babel-runtime/core-js/object/get-prototype-of.js"),i=a(l),d=t("../../npm/babel-runtime/helpers/classCallCheck.js"),c=a(d),p=t("../../npm/babel-runtime/helpers/createClass.js"),f=a(p),h=t("../../npm/babel-runtime/helpers/possibleConstructorReturn.js"),m=a(h),b=t("../../npm/babel-runtime/helpers/inherits.js"),w=a(b),x=t("../../npm/labrador/index.js"),j=a(x),v=t("../../utils/util.js"),y=function(e){function t(){var e,a,n,r;(0,c.default)(this,t);for(var s=arguments.length,u=Array(s),o=0;o<s;o++)u[o]=arguments[o];return a=n=(0,m.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(u))),n.data={planArr:["请选择"],index:0,TextArea:"",useName:"",phone:"",persons:{},arr:{},projectIdArr:[],claimContent:""},r=a,(0,m.default)(n,r)}return(0,w.default)(t,e),(0,f.default)(t,[{key:"bindPickerChange",value:function(e){this.setData({index:e.detail.value})}},{key:"bindTextAreaBlur",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,o.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setData({claimContent:t.detail.value});case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"bindKeyInput",value:function(e){var t=e.currentTarget.dataset.name;this.data.persons[t]=e.detail.value,this.setData({persons:this.data.persons})}},{key:"onSub",value:function(){function e(){return t.apply(this,arguments)}var t=(0,o.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.sleep)(1e3);case 2:if(!(this.data.index>0)){e.next=24;break}if("undefined"!=typeof this.data.persons.name){e.next=6;break}return j.default.showModal({title:"提示",content:"请输入正确姓名",showCancel:!1,success:function(e){}}),e.abrupt("return");case 6:if("undefined"!=typeof this.data.persons.phone){e.next=9;break}return j.default.showModal({title:"提示",content:"请输入有效联系方式",showCancel:!1,success:function(e){}}),e.abrupt("return");case 9:if(!(!this.data.persons.name.length>0)){e.next=12;break}return j.default.showModal({title:"提示",content:"请输入正确姓名",showCancel:!1,success:function(e){}}),e.abrupt("return");case 12:if(!(!this.data.persons.phone.length>0)){e.next=15;break}return j.default.showModal({title:"提示",content:"请输入有效联系方式",showCancel:!1,success:function(e){}}),e.abrupt("return");case 15:if(!(!this.data.claimContent.length>0)){e.next=18;break}return j.default.showModal({title:"提示",content:"请简要输入事件内容",showCancel:!1,success:function(e){}}),e.abrupt("return");case 18:return e.next=20,j.default.request({url:j.default.app.data.ajaxPath+"/wxapi/user/claim/commit",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{claimName:this.data.persons.name,claimContact:this.data.persons.phone,code:j.default.app.globalData.storage.code,projectId:this.data.projectIdArr[this.data.index-1],claimContent:this.data.claimContent}});case 20:t=e.sent,0==t.data.status?j.default.redirectTo({url:"/pages/applyResult/applyResult"}):j.default.showModal({title:"提示",content:t.data.msg,showCancel:!1,success:function(e){}}),e.next=25;break;case 24:j.default.showModal({title:"提示",content:"请选择计划",showCancel:!1,success:function(e){}});case 25:case"end":return e.stop()}},e,this)}));return e}()},{key:"onLoad",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,o.default)(s.default.mark(function e(t){var a,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.default.request({url:j.default.app.data.ajaxPath+"/wxapi/user/claim/index",method:"get",header:{"content-type":"application/x-www-form-urlencoded"},data:{code:j.default.app.globalData.storage.code}});case 2:if(a=e.sent,0==a.data.status){for(n=0;n<a.data.data.length;n++)this.data.planArr.push(a.data.data[n].projectName+" "+a.data.data[n].insuredName),this.data.projectIdArr.push(a.data.data[n].projectId);this.setData({planArr:this.data.planArr,projectIdArr:this.data.projectIdArr})}case 4:case"end":return e.stop()}},e,this)}));return e}()}]),t}(j.default.Component);Page(x._createPage(y))}(module,require);