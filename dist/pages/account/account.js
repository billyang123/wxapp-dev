"use strict";!function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}var n=e.exports={};window=t("../../npm/labrador/global.js");Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../npm/babel-runtime/regenerator/index.js"),u=a(r),s=t("../../npm/babel-runtime/helpers/asyncToGenerator.js"),l=a(s),o=t("../../npm/babel-runtime/core-js/object/get-prototype-of.js"),i=a(o),f=t("../../npm/babel-runtime/helpers/classCallCheck.js"),c=a(f),p=t("../../npm/babel-runtime/helpers/createClass.js"),d=a(p),h=t("../../npm/babel-runtime/helpers/possibleConstructorReturn.js"),b=a(h),g=t("../../npm/babel-runtime/helpers/inherits.js"),v=a(g),m=t("../../npm/labrador/index.js"),k=a(m),x=t("../../components/navbar/navbar.js"),w=a(x),y=function(e){function t(){var e,a,n,r;(0,c.default)(this,t);for(var u=arguments.length,s=Array(u),l=0;l<u;l++)s[l]=arguments[l];return a=n=(0,b.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(s))),n.data={login:!1,userInfo:{},assetsPath:k.default.app.data.assetsPath,wxUserInfo:k.default.app.globalData.userInfo},n.children={navbar:new w.default({cur:2})},r=a,(0,b.default)(n,r)}return(0,v.default)(t,e),(0,d.default)(t,[{key:"linkTo",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,l.default)(u.default.mark(function e(t){var a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this,!this.isLink){e.next=3;break}return e.abrupt("return");case 3:if(this.isLink=!0,this.data.login){e.next=9;break}return e.next=7,k.default.app.doLogin(function(e){a.setData({login:!0,userInfo:e.data}),k.default.navigateTo({url:t.currentTarget.dataset.link})});case 7:e.next=11;break;case 9:return e.next=11,k.default.navigateTo({url:t.currentTarget.dataset.link});case 11:this.isLink=!1;case 12:case"end":return e.stop()}},e,this)}));return e}()},{key:"bindLogin",value:function(){function e(){return t.apply(this,arguments)}var t=(0,l.default)(u.default.mark(function e(){var t;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this,k.default.app.doLogin(function(e,a){t.setData({login:!0,userInfo:e.data,wxUserInfo:a})});case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"makePhoneCall",value:function(e){k.default.app.makePhoneCall(e)}},{key:"initAcount",value:function(){function e(){return t.apply(this,arguments)}var t=(0,l.default)(u.default.mark(function e(){var t;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(k.default.app.globalData.storage||k.default.app.globalData.storage.code){e.next=4;break}this.setData({login:!1}),e.next=8;break;case 4:return e.next=6,k.default.app.getUser(k.default.app.globalData.storage.code);case 6:t=e.sent,t.data.loginStatus?(k.default.app.setUser(t),this.setData({login:!0,userInfo:t.data,wxUserInfo:k.default.app.globalData.userInfo})):this.setData({login:!1});case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"onShow",value:function(){this.initAcount()}},{key:"onPullDownRefresh",value:function(){function e(){return t.apply(this,arguments)}var t=(0,l.default)(u.default.mark(function e(){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initAcount();case 2:k.default.stopPullDownRefresh();case 3:case"end":return e.stop()}},e,this)}));return e}()}]),t}(k.default.Component);Page(m._createPage(y))}(module,require);